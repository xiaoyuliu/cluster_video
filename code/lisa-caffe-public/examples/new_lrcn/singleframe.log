I1003 21:17:27.603301  1390 caffe.cpp:113] Use GPU with device ID 0
I1003 21:17:28.007109  1390 caffe.cpp:121] Starting Optimization
I1003 21:17:28.007359  1390 solver.cpp:32] Initializing solver from parameters: 
test_iter: 500
test_interval: 20000
base_lr: 1e-05
display: 20
max_iter: 92280
lr_policy: "step"
gamma: 0.1
momentum: 0.9
weight_decay: 0.005
stepsize: 20000
snapshot: 92280
snapshot_prefix: "/cs/vml2/xla193/cluster_video/output/UCF-101/snapshots_singleFrame_RGB/"
solver_mode: GPU
device_id: 0
random_seed: 1701
net: "train_test_singleFrame_RGB.prototxt"
test_state {
  stage: "test-on-test"
}
test_initialization: false
I1003 21:17:28.007441  1390 solver.cpp:70] Creating training net from net file: train_test_singleFrame_RGB.prototxt
I1003 21:17:28.009280  1390 net.cpp:258] The NetState phase (0) differed from the phase (1) specified by a rule in layer data
I1003 21:17:28.009841  1390 net.cpp:42] Initializing net from parameters: 
name: "singleFrame_RGB"
state {
  phase: TRAIN
}
layer {
  name: "data"
  type: "ImageData"
  top: "data"
  top: "label"
  include {
    phase: TRAIN
  }
  transform_param {
    mirror: true
    crop_size: 227
    mean_value: 103.939
    mean_value: 116.779
    mean_value: 123.68
    flow: false
  }
  image_data_param {
    source: "/cs/vml2/xla193/cluster_video/output/UCF-101/list_frm-20with0ftlabel.txt"
    batch_size: 50
    shuffle: true
    new_height: 240
    new_width: 320
    root_folder: "frames/"
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 96
    kernel_size: 7
    stride: 2
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0.1
    }
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 384
    kernel_size: 5
    group: 2
    stride: 2
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0.1
    }
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0.1
    }
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
    group: 2
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0.1
    }
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0.1
    }
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 4096
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0.1
    }
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 4096
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0.1
    }
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "loss"
  type: "Python"
  bottom: "fc7"
  bottom: "label"
  top: "loss"
  loss_weight: 1
  python_param {
    module: "mylayers"
    layer: "TripletLossLayer"
  }
}
I1003 21:17:28.010107  1390 layer_factory.hpp:74] Creating layer data
I1003 21:17:28.010140  1390 net.cpp:84] Creating Layer data
I1003 21:17:28.010157  1390 net.cpp:339] data -> data
I1003 21:17:28.010207  1390 net.cpp:339] data -> label
I1003 21:17:28.010229  1390 net.cpp:113] Setting up data
I1003 21:17:28.010246  1390 image_data_layer.cpp:41] Opening file /cs/vml2/xla193/cluster_video/output/UCF-101/list_frm-20with0ftlabel.txt
I1003 21:17:28.388218  1390 image_data_layer.cpp:52] Shuffling data
I1003 21:17:28.506281  1390 image_data_layer.cpp:57] A total of 461393 images.
I1003 21:17:28.509562  1390 image_data_layer.cpp:87] output data size: 50,3,227,227
I1003 21:17:28.523856  1390 net.cpp:120] Top shape: 50 3 227 227 (7729350)
I1003 21:17:28.523872  1390 net.cpp:120] Top shape: 50 (50)
I1003 21:17:28.523886  1390 layer_factory.hpp:74] Creating layer conv1
I1003 21:17:28.523916  1390 net.cpp:84] Creating Layer conv1
I1003 21:17:28.523926  1390 net.cpp:381] conv1 <- data
I1003 21:17:28.523946  1390 net.cpp:339] conv1 -> conv1
I1003 21:17:28.523967  1390 net.cpp:113] Setting up conv1
I1003 21:17:28.524379  1390 net.cpp:120] Top shape: 50 96 111 111 (59140800)
I1003 21:17:28.524404  1390 layer_factory.hpp:74] Creating layer relu1
I1003 21:17:28.524413  1390 net.cpp:84] Creating Layer relu1
I1003 21:17:28.524418  1390 net.cpp:381] relu1 <- conv1
I1003 21:17:28.524425  1390 net.cpp:328] relu1 -> conv1 (in-place)
I1003 21:17:28.524431  1390 net.cpp:113] Setting up relu1
I1003 21:17:28.524441  1390 net.cpp:120] Top shape: 50 96 111 111 (59140800)
I1003 21:17:28.524444  1390 layer_factory.hpp:74] Creating layer pool1
I1003 21:17:28.524453  1390 net.cpp:84] Creating Layer pool1
I1003 21:17:28.524461  1390 net.cpp:381] pool1 <- conv1
I1003 21:17:28.524466  1390 net.cpp:339] pool1 -> pool1
I1003 21:17:28.524477  1390 net.cpp:113] Setting up pool1
I1003 21:17:28.524503  1390 net.cpp:120] Top shape: 50 96 55 55 (14520000)
I1003 21:17:28.524510  1390 layer_factory.hpp:74] Creating layer norm1
I1003 21:17:28.524523  1390 net.cpp:84] Creating Layer norm1
I1003 21:17:28.524528  1390 net.cpp:381] norm1 <- pool1
I1003 21:17:28.524533  1390 net.cpp:339] norm1 -> norm1
I1003 21:17:28.524545  1390 net.cpp:113] Setting up norm1
I1003 21:17:28.524559  1390 net.cpp:120] Top shape: 50 96 55 55 (14520000)
I1003 21:17:28.524564  1390 layer_factory.hpp:74] Creating layer conv2
I1003 21:17:28.524572  1390 net.cpp:84] Creating Layer conv2
I1003 21:17:28.524576  1390 net.cpp:381] conv2 <- norm1
I1003 21:17:28.524582  1390 net.cpp:339] conv2 -> conv2
I1003 21:17:28.524590  1390 net.cpp:113] Setting up conv2
I1003 21:17:28.534729  1390 net.cpp:120] Top shape: 50 384 26 26 (12979200)
I1003 21:17:28.534747  1390 layer_factory.hpp:74] Creating layer relu2
I1003 21:17:28.534755  1390 net.cpp:84] Creating Layer relu2
I1003 21:17:28.534759  1390 net.cpp:381] relu2 <- conv2
I1003 21:17:28.534765  1390 net.cpp:328] relu2 -> conv2 (in-place)
I1003 21:17:28.534773  1390 net.cpp:113] Setting up relu2
I1003 21:17:28.534780  1390 net.cpp:120] Top shape: 50 384 26 26 (12979200)
I1003 21:17:28.534785  1390 layer_factory.hpp:74] Creating layer pool2
I1003 21:17:28.534792  1390 net.cpp:84] Creating Layer pool2
I1003 21:17:28.534796  1390 net.cpp:381] pool2 <- conv2
I1003 21:17:28.534806  1390 net.cpp:339] pool2 -> pool2
I1003 21:17:28.534816  1390 net.cpp:113] Setting up pool2
I1003 21:17:28.534826  1390 net.cpp:120] Top shape: 50 384 13 13 (3244800)
I1003 21:17:28.534832  1390 layer_factory.hpp:74] Creating layer norm2
I1003 21:17:28.534852  1390 net.cpp:84] Creating Layer norm2
I1003 21:17:28.534859  1390 net.cpp:381] norm2 <- pool2
I1003 21:17:28.534867  1390 net.cpp:339] norm2 -> norm2
I1003 21:17:28.534873  1390 net.cpp:113] Setting up norm2
I1003 21:17:28.534885  1390 net.cpp:120] Top shape: 50 384 13 13 (3244800)
I1003 21:17:28.534889  1390 layer_factory.hpp:74] Creating layer conv3
I1003 21:17:28.534906  1390 net.cpp:84] Creating Layer conv3
I1003 21:17:28.534914  1390 net.cpp:381] conv3 <- norm2
I1003 21:17:28.534921  1390 net.cpp:339] conv3 -> conv3
I1003 21:17:28.534935  1390 net.cpp:113] Setting up conv3
I1003 21:17:28.573583  1390 net.cpp:120] Top shape: 50 512 13 13 (4326400)
I1003 21:17:28.573603  1390 layer_factory.hpp:74] Creating layer relu3
I1003 21:17:28.573618  1390 net.cpp:84] Creating Layer relu3
I1003 21:17:28.573622  1390 net.cpp:381] relu3 <- conv3
I1003 21:17:28.573628  1390 net.cpp:328] relu3 -> conv3 (in-place)
I1003 21:17:28.573635  1390 net.cpp:113] Setting up relu3
I1003 21:17:28.573642  1390 net.cpp:120] Top shape: 50 512 13 13 (4326400)
I1003 21:17:28.573647  1390 layer_factory.hpp:74] Creating layer conv4
I1003 21:17:28.573655  1390 net.cpp:84] Creating Layer conv4
I1003 21:17:28.573660  1390 net.cpp:381] conv4 <- conv3
I1003 21:17:28.573669  1390 net.cpp:339] conv4 -> conv4
I1003 21:17:28.573678  1390 net.cpp:113] Setting up conv4
I1003 21:17:28.599256  1390 net.cpp:120] Top shape: 50 512 13 13 (4326400)
I1003 21:17:28.599273  1390 layer_factory.hpp:74] Creating layer relu4
I1003 21:17:28.599282  1390 net.cpp:84] Creating Layer relu4
I1003 21:17:28.599285  1390 net.cpp:381] relu4 <- conv4
I1003 21:17:28.599292  1390 net.cpp:328] relu4 -> conv4 (in-place)
I1003 21:17:28.599301  1390 net.cpp:113] Setting up relu4
I1003 21:17:28.599308  1390 net.cpp:120] Top shape: 50 512 13 13 (4326400)
I1003 21:17:28.599311  1390 layer_factory.hpp:74] Creating layer conv5
I1003 21:17:28.599320  1390 net.cpp:84] Creating Layer conv5
I1003 21:17:28.599324  1390 net.cpp:381] conv5 <- conv4
I1003 21:17:28.599330  1390 net.cpp:339] conv5 -> conv5
I1003 21:17:28.599337  1390 net.cpp:113] Setting up conv5
I1003 21:17:28.618247  1390 net.cpp:120] Top shape: 50 384 13 13 (3244800)
I1003 21:17:28.618265  1390 layer_factory.hpp:74] Creating layer relu5
I1003 21:17:28.618273  1390 net.cpp:84] Creating Layer relu5
I1003 21:17:28.618276  1390 net.cpp:381] relu5 <- conv5
I1003 21:17:28.618286  1390 net.cpp:328] relu5 -> conv5 (in-place)
I1003 21:17:28.618293  1390 net.cpp:113] Setting up relu5
I1003 21:17:28.618299  1390 net.cpp:120] Top shape: 50 384 13 13 (3244800)
I1003 21:17:28.618304  1390 layer_factory.hpp:74] Creating layer pool5
I1003 21:17:28.618310  1390 net.cpp:84] Creating Layer pool5
I1003 21:17:28.618314  1390 net.cpp:381] pool5 <- conv5
I1003 21:17:28.618324  1390 net.cpp:339] pool5 -> pool5
I1003 21:17:28.618333  1390 net.cpp:113] Setting up pool5
I1003 21:17:28.618343  1390 net.cpp:120] Top shape: 50 384 6 6 (691200)
I1003 21:17:28.618350  1390 layer_factory.hpp:74] Creating layer fc6
I1003 21:17:28.618362  1390 net.cpp:84] Creating Layer fc6
I1003 21:17:28.618366  1390 net.cpp:381] fc6 <- pool5
I1003 21:17:28.618379  1390 net.cpp:339] fc6 -> fc6
I1003 21:17:28.618393  1390 net.cpp:113] Setting up fc6
I1003 21:17:29.755614  1390 net.cpp:120] Top shape: 50 4096 (204800)
I1003 21:17:29.755647  1390 layer_factory.hpp:74] Creating layer relu6
I1003 21:17:29.755664  1390 net.cpp:84] Creating Layer relu6
I1003 21:17:29.755671  1390 net.cpp:381] relu6 <- fc6
I1003 21:17:29.755679  1390 net.cpp:328] relu6 -> fc6 (in-place)
I1003 21:17:29.755689  1390 net.cpp:113] Setting up relu6
I1003 21:17:29.755697  1390 net.cpp:120] Top shape: 50 4096 (204800)
I1003 21:17:29.755702  1390 layer_factory.hpp:74] Creating layer drop6
I1003 21:17:29.755717  1390 net.cpp:84] Creating Layer drop6
I1003 21:17:29.755722  1390 net.cpp:381] drop6 <- fc6
I1003 21:17:29.755726  1390 net.cpp:328] drop6 -> fc6 (in-place)
I1003 21:17:29.755738  1390 net.cpp:113] Setting up drop6
I1003 21:17:29.755755  1390 net.cpp:120] Top shape: 50 4096 (204800)
I1003 21:17:29.755761  1390 layer_factory.hpp:74] Creating layer fc7
I1003 21:17:29.755774  1390 net.cpp:84] Creating Layer fc7
I1003 21:17:29.755779  1390 net.cpp:381] fc7 <- fc6
I1003 21:17:29.755786  1390 net.cpp:339] fc7 -> fc7
I1003 21:17:29.755795  1390 net.cpp:113] Setting up fc7
I1003 21:17:30.093772  1390 net.cpp:120] Top shape: 50 4096 (204800)
I1003 21:17:30.093804  1390 layer_factory.hpp:74] Creating layer relu7
I1003 21:17:30.093817  1390 net.cpp:84] Creating Layer relu7
I1003 21:17:30.093825  1390 net.cpp:381] relu7 <- fc7
I1003 21:17:30.093833  1390 net.cpp:328] relu7 -> fc7 (in-place)
I1003 21:17:30.093844  1390 net.cpp:113] Setting up relu7
I1003 21:17:30.093852  1390 net.cpp:120] Top shape: 50 4096 (204800)
I1003 21:17:30.093855  1390 layer_factory.hpp:74] Creating layer drop7
I1003 21:17:30.093868  1390 net.cpp:84] Creating Layer drop7
I1003 21:17:30.093871  1390 net.cpp:381] drop7 <- fc7
I1003 21:17:30.093878  1390 net.cpp:328] drop7 -> fc7 (in-place)
I1003 21:17:30.093883  1390 net.cpp:113] Setting up drop7
I1003 21:17:30.093891  1390 net.cpp:120] Top shape: 50 4096 (204800)
I1003 21:17:30.093895  1390 layer_factory.hpp:74] Creating layer loss
I1003 21:17:33.811158  1390 net.cpp:84] Creating Layer loss
I1003 21:17:33.811194  1390 net.cpp:381] loss <- fc7
I1003 21:17:33.811208  1390 net.cpp:381] loss <- label
I1003 21:17:33.811224  1390 net.cpp:339] loss -> loss
I1003 21:17:33.811240  1390 net.cpp:113] Setting up loss
I1003 21:17:33.811322  1390 net.cpp:120] Top shape: 1 (1)
I1003 21:17:33.811333  1390 net.cpp:122]     with loss weight 1
I1003 21:17:33.811378  1390 net.cpp:167] loss needs backward computation.
I1003 21:17:33.811388  1390 net.cpp:167] drop7 needs backward computation.
I1003 21:17:33.811393  1390 net.cpp:167] relu7 needs backward computation.
I1003 21:17:33.811398  1390 net.cpp:167] fc7 needs backward computation.
I1003 21:17:33.811404  1390 net.cpp:167] drop6 needs backward computation.
I1003 21:17:33.811410  1390 net.cpp:167] relu6 needs backward computation.
I1003 21:17:33.811415  1390 net.cpp:167] fc6 needs backward computation.
I1003 21:17:33.811421  1390 net.cpp:167] pool5 needs backward computation.
I1003 21:17:33.811429  1390 net.cpp:167] relu5 needs backward computation.
I1003 21:17:33.811434  1390 net.cpp:167] conv5 needs backward computation.
I1003 21:17:33.811440  1390 net.cpp:167] relu4 needs backward computation.
I1003 21:17:33.811445  1390 net.cpp:167] conv4 needs backward computation.
I1003 21:17:33.811450  1390 net.cpp:167] relu3 needs backward computation.
I1003 21:17:33.811455  1390 net.cpp:167] conv3 needs backward computation.
I1003 21:17:33.811461  1390 net.cpp:167] norm2 needs backward computation.
I1003 21:17:33.811467  1390 net.cpp:167] pool2 needs backward computation.
I1003 21:17:33.811472  1390 net.cpp:167] relu2 needs backward computation.
I1003 21:17:33.811477  1390 net.cpp:167] conv2 needs backward computation.
I1003 21:17:33.811483  1390 net.cpp:167] norm1 needs backward computation.
I1003 21:17:33.811489  1390 net.cpp:167] pool1 needs backward computation.
I1003 21:17:33.811494  1390 net.cpp:167] relu1 needs backward computation.
I1003 21:17:33.811499  1390 net.cpp:167] conv1 needs backward computation.
I1003 21:17:33.811506  1390 net.cpp:169] data does not need backward computation.
I1003 21:17:33.811511  1390 net.cpp:205] This network produces output loss
I1003 21:17:33.811545  1390 net.cpp:446] Collecting Learning Rate and Weight Decay.
I1003 21:17:33.811563  1390 net.cpp:218] Network initialization done.
I1003 21:17:33.811569  1390 net.cpp:219] Memory required for data: 852856804
I1003 21:17:33.813189  1390 solver.cpp:154] Creating test net (#0) specified by net file: train_test_singleFrame_RGB.prototxt
I1003 21:17:33.813292  1390 net.cpp:258] The NetState phase (1) differed from the phase (0) specified by a rule in layer data
I1003 21:17:33.813823  1390 net.cpp:42] Initializing net from parameters: 
name: "singleFrame_RGB"
state {
  phase: TEST
  stage: "test-on-test"
}
layer {
  name: "data"
  type: "ImageData"
  top: "data"
  top: "label"
  include {
    phase: TEST
  }
  transform_param {
    mirror: true
    crop_size: 227
    mean_value: 103.939
    mean_value: 116.779
    mean_value: 123.68
    flow: false
  }
  image_data_param {
    source: "/cs/vml2/xla193/cluster_video/output/UCF-101/list_frm-20with0ftlabel.txt"
    batch_size: 50
    shuffle: true
    new_height: 240
    new_width: 320
    root_folder: "frames/"
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 96
    kernel_size: 7
    stride: 2
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0.1
    }
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 384
    kernel_size: 5
    group: 2
    stride: 2
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0.1
    }
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0.1
    }
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
    group: 2
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0.1
    }
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0.1
    }
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 4096
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0.1
    }
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 4096
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0.1
    }
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "loss"
  type: "Python"
  bottom: "fc7"
  bottom: "label"
  top: "loss"
  loss_weight: 1
  python_param {
    module: "mylayers"
    layer: "TripletLossLayer"
  }
}
I1003 21:17:33.813993  1390 layer_factory.hpp:74] Creating layer data
I1003 21:17:33.814010  1390 net.cpp:84] Creating Layer data
I1003 21:17:33.814019  1390 net.cpp:339] data -> data
I1003 21:17:33.814034  1390 net.cpp:339] data -> label
I1003 21:17:33.814046  1390 net.cpp:113] Setting up data
I1003 21:17:33.814052  1390 image_data_layer.cpp:41] Opening file /cs/vml2/xla193/cluster_video/output/UCF-101/list_frm-20with0ftlabel.txt
I1003 21:17:34.185825  1390 image_data_layer.cpp:52] Shuffling data
I1003 21:17:34.304110  1390 image_data_layer.cpp:57] A total of 461393 images.
I1003 21:17:34.307224  1390 image_data_layer.cpp:87] output data size: 50,3,227,227
I1003 21:17:34.321483  1390 net.cpp:120] Top shape: 50 3 227 227 (7729350)
I1003 21:17:34.321498  1390 net.cpp:120] Top shape: 50 (50)
I1003 21:17:34.321507  1390 layer_factory.hpp:74] Creating layer conv1
I1003 21:17:34.321532  1390 net.cpp:84] Creating Layer conv1
I1003 21:17:34.321537  1390 net.cpp:381] conv1 <- data
I1003 21:17:34.321549  1390 net.cpp:339] conv1 -> conv1
I1003 21:17:34.321568  1390 net.cpp:113] Setting up conv1
I1003 21:17:34.321902  1390 net.cpp:120] Top shape: 50 96 111 111 (59140800)
I1003 21:17:34.321923  1390 layer_factory.hpp:74] Creating layer relu1
I1003 21:17:34.321933  1390 net.cpp:84] Creating Layer relu1
I1003 21:17:34.321936  1390 net.cpp:381] relu1 <- conv1
I1003 21:17:34.321949  1390 net.cpp:328] relu1 -> conv1 (in-place)
I1003 21:17:34.321959  1390 net.cpp:113] Setting up relu1
I1003 21:17:34.321967  1390 net.cpp:120] Top shape: 50 96 111 111 (59140800)
I1003 21:17:34.321972  1390 layer_factory.hpp:74] Creating layer pool1
I1003 21:17:34.321981  1390 net.cpp:84] Creating Layer pool1
I1003 21:17:34.321987  1390 net.cpp:381] pool1 <- conv1
I1003 21:17:34.321995  1390 net.cpp:339] pool1 -> pool1
I1003 21:17:34.322002  1390 net.cpp:113] Setting up pool1
I1003 21:17:34.322015  1390 net.cpp:120] Top shape: 50 96 55 55 (14520000)
I1003 21:17:34.322021  1390 layer_factory.hpp:74] Creating layer norm1
I1003 21:17:34.322031  1390 net.cpp:84] Creating Layer norm1
I1003 21:17:34.322033  1390 net.cpp:381] norm1 <- pool1
I1003 21:17:34.322039  1390 net.cpp:339] norm1 -> norm1
I1003 21:17:34.322048  1390 net.cpp:113] Setting up norm1
I1003 21:17:34.322059  1390 net.cpp:120] Top shape: 50 96 55 55 (14520000)
I1003 21:17:34.322065  1390 layer_factory.hpp:74] Creating layer conv2
I1003 21:17:34.322075  1390 net.cpp:84] Creating Layer conv2
I1003 21:17:34.322082  1390 net.cpp:381] conv2 <- norm1
I1003 21:17:34.322088  1390 net.cpp:339] conv2 -> conv2
I1003 21:17:34.322101  1390 net.cpp:113] Setting up conv2
I1003 21:17:34.331754  1390 net.cpp:120] Top shape: 50 384 26 26 (12979200)
I1003 21:17:34.331773  1390 layer_factory.hpp:74] Creating layer relu2
I1003 21:17:34.331781  1390 net.cpp:84] Creating Layer relu2
I1003 21:17:34.331789  1390 net.cpp:381] relu2 <- conv2
I1003 21:17:34.331796  1390 net.cpp:328] relu2 -> conv2 (in-place)
I1003 21:17:34.331804  1390 net.cpp:113] Setting up relu2
I1003 21:17:34.331810  1390 net.cpp:120] Top shape: 50 384 26 26 (12979200)
I1003 21:17:34.331815  1390 layer_factory.hpp:74] Creating layer pool2
I1003 21:17:34.331821  1390 net.cpp:84] Creating Layer pool2
I1003 21:17:34.331825  1390 net.cpp:381] pool2 <- conv2
I1003 21:17:34.331831  1390 net.cpp:339] pool2 -> pool2
I1003 21:17:34.331838  1390 net.cpp:113] Setting up pool2
I1003 21:17:34.331848  1390 net.cpp:120] Top shape: 50 384 13 13 (3244800)
I1003 21:17:34.331854  1390 layer_factory.hpp:74] Creating layer norm2
I1003 21:17:34.331867  1390 net.cpp:84] Creating Layer norm2
I1003 21:17:34.331873  1390 net.cpp:381] norm2 <- pool2
I1003 21:17:34.331883  1390 net.cpp:339] norm2 -> norm2
I1003 21:17:34.331892  1390 net.cpp:113] Setting up norm2
I1003 21:17:34.331900  1390 net.cpp:120] Top shape: 50 384 13 13 (3244800)
I1003 21:17:34.331904  1390 layer_factory.hpp:74] Creating layer conv3
I1003 21:17:34.331913  1390 net.cpp:84] Creating Layer conv3
I1003 21:17:34.331918  1390 net.cpp:381] conv3 <- norm2
I1003 21:17:34.331928  1390 net.cpp:339] conv3 -> conv3
I1003 21:17:34.331938  1390 net.cpp:113] Setting up conv3
I1003 21:17:34.369952  1390 net.cpp:120] Top shape: 50 512 13 13 (4326400)
I1003 21:17:34.369972  1390 layer_factory.hpp:74] Creating layer relu3
I1003 21:17:34.369982  1390 net.cpp:84] Creating Layer relu3
I1003 21:17:34.369987  1390 net.cpp:381] relu3 <- conv3
I1003 21:17:34.369997  1390 net.cpp:328] relu3 -> conv3 (in-place)
I1003 21:17:34.370003  1390 net.cpp:113] Setting up relu3
I1003 21:17:34.370010  1390 net.cpp:120] Top shape: 50 512 13 13 (4326400)
I1003 21:17:34.370014  1390 layer_factory.hpp:74] Creating layer conv4
I1003 21:17:34.370023  1390 net.cpp:84] Creating Layer conv4
I1003 21:17:34.370026  1390 net.cpp:381] conv4 <- conv3
I1003 21:17:34.370035  1390 net.cpp:339] conv4 -> conv4
I1003 21:17:34.370046  1390 net.cpp:113] Setting up conv4
I1003 21:17:34.395651  1390 net.cpp:120] Top shape: 50 512 13 13 (4326400)
I1003 21:17:34.395681  1390 layer_factory.hpp:74] Creating layer relu4
I1003 21:17:34.395694  1390 net.cpp:84] Creating Layer relu4
I1003 21:17:34.395697  1390 net.cpp:381] relu4 <- conv4
I1003 21:17:34.395704  1390 net.cpp:328] relu4 -> conv4 (in-place)
I1003 21:17:34.395711  1390 net.cpp:113] Setting up relu4
I1003 21:17:34.395719  1390 net.cpp:120] Top shape: 50 512 13 13 (4326400)
I1003 21:17:34.395722  1390 layer_factory.hpp:74] Creating layer conv5
I1003 21:17:34.395737  1390 net.cpp:84] Creating Layer conv5
I1003 21:17:34.395745  1390 net.cpp:381] conv5 <- conv4
I1003 21:17:34.395751  1390 net.cpp:339] conv5 -> conv5
I1003 21:17:34.395758  1390 net.cpp:113] Setting up conv5
I1003 21:17:34.414696  1390 net.cpp:120] Top shape: 50 384 13 13 (3244800)
I1003 21:17:34.414716  1390 layer_factory.hpp:74] Creating layer relu5
I1003 21:17:34.414724  1390 net.cpp:84] Creating Layer relu5
I1003 21:17:34.414728  1390 net.cpp:381] relu5 <- conv5
I1003 21:17:34.414736  1390 net.cpp:328] relu5 -> conv5 (in-place)
I1003 21:17:34.414741  1390 net.cpp:113] Setting up relu5
I1003 21:17:34.414748  1390 net.cpp:120] Top shape: 50 384 13 13 (3244800)
I1003 21:17:34.414754  1390 layer_factory.hpp:74] Creating layer pool5
I1003 21:17:34.414765  1390 net.cpp:84] Creating Layer pool5
I1003 21:17:34.414772  1390 net.cpp:381] pool5 <- conv5
I1003 21:17:34.414778  1390 net.cpp:339] pool5 -> pool5
I1003 21:17:34.414786  1390 net.cpp:113] Setting up pool5
I1003 21:17:34.414798  1390 net.cpp:120] Top shape: 50 384 6 6 (691200)
I1003 21:17:34.414803  1390 layer_factory.hpp:74] Creating layer fc6
I1003 21:17:34.414816  1390 net.cpp:84] Creating Layer fc6
I1003 21:17:34.414827  1390 net.cpp:381] fc6 <- pool5
I1003 21:17:34.414834  1390 net.cpp:339] fc6 -> fc6
I1003 21:17:34.414841  1390 net.cpp:113] Setting up fc6
I1003 21:17:35.553457  1390 net.cpp:120] Top shape: 50 4096 (204800)
I1003 21:17:35.553493  1390 layer_factory.hpp:74] Creating layer relu6
I1003 21:17:35.553508  1390 net.cpp:84] Creating Layer relu6
I1003 21:17:35.553514  1390 net.cpp:381] relu6 <- fc6
I1003 21:17:35.553525  1390 net.cpp:328] relu6 -> fc6 (in-place)
I1003 21:17:35.553535  1390 net.cpp:113] Setting up relu6
I1003 21:17:35.553544  1390 net.cpp:120] Top shape: 50 4096 (204800)
I1003 21:17:35.553547  1390 layer_factory.hpp:74] Creating layer drop6
I1003 21:17:35.553557  1390 net.cpp:84] Creating Layer drop6
I1003 21:17:35.553561  1390 net.cpp:381] drop6 <- fc6
I1003 21:17:35.553566  1390 net.cpp:328] drop6 -> fc6 (in-place)
I1003 21:17:35.553572  1390 net.cpp:113] Setting up drop6
I1003 21:17:35.553581  1390 net.cpp:120] Top shape: 50 4096 (204800)
I1003 21:17:35.553586  1390 layer_factory.hpp:74] Creating layer fc7
I1003 21:17:35.553596  1390 net.cpp:84] Creating Layer fc7
I1003 21:17:35.553601  1390 net.cpp:381] fc7 <- fc6
I1003 21:17:35.553611  1390 net.cpp:339] fc7 -> fc7
I1003 21:17:35.553622  1390 net.cpp:113] Setting up fc7
I1003 21:17:35.897792  1390 net.cpp:120] Top shape: 50 4096 (204800)
I1003 21:17:35.897827  1390 layer_factory.hpp:74] Creating layer relu7
I1003 21:17:35.897843  1390 net.cpp:84] Creating Layer relu7
I1003 21:17:35.897850  1390 net.cpp:381] relu7 <- fc7
I1003 21:17:35.897860  1390 net.cpp:328] relu7 -> fc7 (in-place)
I1003 21:17:35.897871  1390 net.cpp:113] Setting up relu7
I1003 21:17:35.897878  1390 net.cpp:120] Top shape: 50 4096 (204800)
I1003 21:17:35.897882  1390 layer_factory.hpp:74] Creating layer drop7
I1003 21:17:35.897892  1390 net.cpp:84] Creating Layer drop7
I1003 21:17:35.897897  1390 net.cpp:381] drop7 <- fc7
I1003 21:17:35.897905  1390 net.cpp:328] drop7 -> fc7 (in-place)
I1003 21:17:35.897912  1390 net.cpp:113] Setting up drop7
I1003 21:17:35.897920  1390 net.cpp:120] Top shape: 50 4096 (204800)
I1003 21:17:35.897924  1390 layer_factory.hpp:74] Creating layer loss
I1003 21:17:35.898020  1390 net.cpp:84] Creating Layer loss
I1003 21:17:35.898030  1390 net.cpp:381] loss <- fc7
I1003 21:17:35.898036  1390 net.cpp:381] loss <- label
I1003 21:17:35.898043  1390 net.cpp:339] loss -> loss
I1003 21:17:35.898052  1390 net.cpp:113] Setting up loss
I1003 21:17:35.898109  1390 net.cpp:120] Top shape: 1 (1)
I1003 21:17:35.898116  1390 net.cpp:122]     with loss weight 1
I1003 21:17:35.898136  1390 net.cpp:167] loss needs backward computation.
I1003 21:17:35.898142  1390 net.cpp:167] drop7 needs backward computation.
I1003 21:17:35.898146  1390 net.cpp:167] relu7 needs backward computation.
I1003 21:17:35.898149  1390 net.cpp:167] fc7 needs backward computation.
I1003 21:17:35.898154  1390 net.cpp:167] drop6 needs backward computation.
I1003 21:17:35.898159  1390 net.cpp:167] relu6 needs backward computation.
I1003 21:17:35.898162  1390 net.cpp:167] fc6 needs backward computation.
I1003 21:17:35.898167  1390 net.cpp:167] pool5 needs backward computation.
I1003 21:17:35.898172  1390 net.cpp:167] relu5 needs backward computation.
I1003 21:17:35.898176  1390 net.cpp:167] conv5 needs backward computation.
I1003 21:17:35.898181  1390 net.cpp:167] relu4 needs backward computation.
I1003 21:17:35.898186  1390 net.cpp:167] conv4 needs backward computation.
I1003 21:17:35.898190  1390 net.cpp:167] relu3 needs backward computation.
I1003 21:17:35.898195  1390 net.cpp:167] conv3 needs backward computation.
I1003 21:17:35.898200  1390 net.cpp:167] norm2 needs backward computation.
I1003 21:17:35.898205  1390 net.cpp:167] pool2 needs backward computation.
I1003 21:17:35.898210  1390 net.cpp:167] relu2 needs backward computation.
I1003 21:17:35.898213  1390 net.cpp:167] conv2 needs backward computation.
I1003 21:17:35.898217  1390 net.cpp:167] norm1 needs backward computation.
I1003 21:17:35.898222  1390 net.cpp:167] pool1 needs backward computation.
I1003 21:17:35.898227  1390 net.cpp:167] relu1 needs backward computation.
I1003 21:17:35.898231  1390 net.cpp:167] conv1 needs backward computation.
I1003 21:17:35.898236  1390 net.cpp:169] data does not need backward computation.
I1003 21:17:35.898239  1390 net.cpp:205] This network produces output loss
I1003 21:17:35.898264  1390 net.cpp:446] Collecting Learning Rate and Weight Decay.
I1003 21:17:35.898275  1390 net.cpp:218] Network initialization done.
I1003 21:17:35.898282  1390 net.cpp:219] Memory required for data: 852856804
I1003 21:17:35.898440  1390 solver.cpp:42] Solver scaffolding done.
I1003 21:17:35.898496  1390 caffe.cpp:86] Finetuning from /cs/vml2/xla193/cluster_video/output/UCF-101/caffe_imagenet_hyb2_wr_rc_solver_sqrt_iter_310000
E1003 21:17:36.224303  1390 upgrade_proto.cpp:591] Attempting to upgrade input file specified using deprecated V0LayerParameter: /cs/vml2/xla193/cluster_video/output/UCF-101/caffe_imagenet_hyb2_wr_rc_solver_sqrt_iter_310000
I1003 21:17:36.837976  1390 upgrade_proto.cpp:599] Successfully upgraded file specified using deprecated V0LayerParameter
E1003 21:17:36.838011  1390 upgrade_proto.cpp:602] Note that future Caffe releases will not support V0NetParameter; use ./build/tools/upgrade_net_proto_text for prototxt and ./build/tools/upgrade_net_proto_binary for model weights upgrade this and any other net protos to the new format.
E1003 21:17:36.839947  1390 upgrade_proto.cpp:618] Attempting to upgrade input file specified using deprecated V1LayerParameter: /cs/vml2/xla193/cluster_video/output/UCF-101/caffe_imagenet_hyb2_wr_rc_solver_sqrt_iter_310000
I1003 21:17:37.261214  1390 upgrade_proto.cpp:626] Successfully upgraded file specified using deprecated V1LayerParameter
E1003 21:17:37.675827  1390 upgrade_proto.cpp:591] Attempting to upgrade input file specified using deprecated V0LayerParameter: /cs/vml2/xla193/cluster_video/output/UCF-101/caffe_imagenet_hyb2_wr_rc_solver_sqrt_iter_310000
I1003 21:17:38.288305  1390 upgrade_proto.cpp:599] Successfully upgraded file specified using deprecated V0LayerParameter
E1003 21:17:38.288341  1390 upgrade_proto.cpp:602] Note that future Caffe releases will not support V0NetParameter; use ./build/tools/upgrade_net_proto_text for prototxt and ./build/tools/upgrade_net_proto_binary for model weights upgrade this and any other net protos to the new format.
E1003 21:17:38.289593  1390 upgrade_proto.cpp:618] Attempting to upgrade input file specified using deprecated V1LayerParameter: /cs/vml2/xla193/cluster_video/output/UCF-101/caffe_imagenet_hyb2_wr_rc_solver_sqrt_iter_310000
I1003 21:17:38.685842  1390 upgrade_proto.cpp:626] Successfully upgraded file specified using deprecated V1LayerParameter
I1003 21:17:38.783965  1390 solver.cpp:247] Solving singleFrame_RGB
I1003 21:17:38.783996  1390 solver.cpp:248] Learning Rate Policy: step
I1003 21:17:39.574303  1390 solver.cpp:214] Iteration 0, loss = 203.682
I1003 21:17:39.574362  1390 solver.cpp:229]     Train net output #0: loss = 203.682 (* 1 = 203.682 loss)
I1003 21:17:39.574395  1390 solver.cpp:489] Iteration 0, lr = 1e-05
I1003 21:17:57.130427  1390 solver.cpp:214] Iteration 20, loss = 4.0891
I1003 21:17:57.130488  1390 solver.cpp:229]     Train net output #0: loss = 4.0891 (* 1 = 4.0891 loss)
I1003 21:17:57.130503  1390 solver.cpp:489] Iteration 20, lr = 1e-05
I1003 21:18:14.923244  1390 solver.cpp:214] Iteration 40, loss = 1.80781
I1003 21:18:14.923303  1390 solver.cpp:229]     Train net output #0: loss = 1.80781 (* 1 = 1.80781 loss)
I1003 21:18:14.923317  1390 solver.cpp:489] Iteration 40, lr = 1e-05
I1003 21:18:32.659353  1390 solver.cpp:214] Iteration 60, loss = 1.50252
I1003 21:18:32.659409  1390 solver.cpp:229]     Train net output #0: loss = 1.50252 (* 1 = 1.50252 loss)
I1003 21:18:32.659423  1390 solver.cpp:489] Iteration 60, lr = 1e-05
